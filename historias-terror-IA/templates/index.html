<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <title>ðŸ‘» Historias de Terror</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
  <div class="container">
    <h1>Generador de Historias de Terror</h1>
    <button id="btn">Generar Historia</button>
    <div id="story"></div>
    <audio id="audio" controls></audio>
  </div>

  <script>
    const btn = document.getElementById("btn");
    const storyDiv = document.getElementById("story");
    const audio = document.getElementById("audio");

    btn.addEventListener("click", async () => {
      // Generar historia
      const storyRes = await fetch("/generate-story", { method: "POST" });
      const storyData = await storyRes.json();
      storyDiv.innerHTML = `<p>${storyData.story}</p>`;

      // Generar audio
      const audioRes = await fetch("/generate-audio", {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify({ text: storyData.story })
      });

      if (!audioRes.ok) {
        alert("Hubo un error generando el audio.");
        return;
      }

      const blob = await audioRes.blob();
      const url = URL.createObjectURL(blob);
      audio.src = url;
      audio.play();
    });
  </script>
</body>
</html>